(()=>{"use strict";var e={851:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isMatchingQuery=t.orderValues=void 0,t.orderValues=function(e,t){(null==t?void 0:t.orderBy)&&e.sort((function(e,r){return e[t.orderBy.key]<r[t.orderBy.key]&&"desc"===t.orderBy.direction||e[t.orderBy.key]>r[t.orderBy.key]&&"asc"===t.orderBy.direction?-1:e[t.orderBy.key]>r[t.orderBy.key]&&"desc"===t.orderBy.direction||e[t.orderBy.key]<r[t.orderBy.key]&&"asc"===t.orderBy.direction?1:0}))},t.isMatchingQuery=function(e,t){if(null==t?void 0:t.where){var r=e;switch(t.where.operator){case"==":if(r[t.where.key]===t.where.value)return!0;break;case"!=":if(r[t.where.key]!==t.where.value)return!0;break;case"<":if(r[t.where.key]<t.where.value)return!0;break;case"<=":if(r[t.where.key]<=t.where.value)return!0;break;case">":if(r[t.where.key]>t.where.value)return!0;break;case">=":if(r[t.where.key]>=t.where.value)return!0;break;case"between":if(r[t.where.key]>=t.where.value[0]&&r[t.where.key]<=t.where.value[1])return!0;break;case"in":if(t.where.value.includes(r[t.where.key]))return!0;break;case"not-in":if(!t.where.value.includes(r[t.where.key]))return!0}return!1}return!0}},835:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{s(n.next(e))}catch(e){i(e)}}function u(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,u)}s((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(s){return function(u){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&u[0]?n.return:u[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,u[1])).done)return o;switch(n=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,n=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(e){u=[6,e],n=0}finally{r=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.InMemoryDatabaseConnector=void 0;var i=r(917),a=function(){function e(e,t){this.dbKey=e,this.layout=t}return e.prototype.open=function(){return n(this,void 0,void 0,(function(){var e,t,r;return o(this,(function(n){for(this.tables=new Map,e=0,t=Object.keys(this.layout);e<t.length;e++)r=t[e],this.tables.set(r,new i.InMemoryDatabaseTableConnector);return[2]}))}))},e.prototype.close=function(){this.tables=void 0},e.prototype.hasTable=function(e){var t,r;return null!==(r=null===(t=this.tables)||void 0===t?void 0:t.has(e))&&void 0!==r&&r},e.prototype.createTable=function(e){if(!this.tables)throw new Error("Database not open");if(this.tables.has(e))throw new Error("Table already exists");this.tables.set(e,new i.InMemoryDatabaseTableConnector)},e.prototype.getTableConnector=function(e){if(!this.tables)throw new Error("Database not open");this.tables.has(e)||this.tables.set(e,new i.InMemoryDatabaseTableConnector);var t=this.tables.get(e);if(!t)throw new Error("Table not found");return t},e}();t.InMemoryDatabaseConnector=a},917:function(e,t,r){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)},o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{s(n.next(e))}catch(e){i(e)}}function u(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,u)}s((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(s){return function(u){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&u[0]?n.return:u[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,u[1])).done)return o;switch(n=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,n=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(e){u=[6,e],n=0}finally{r=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.InMemoryDatabaseTableConnector=void 0;var a=r(903),u=r(851),s=function(){function e(){this.store=new Map}return e.prototype.get=function(e){return o(this,void 0,void 0,(function(){return i(this,(function(t){return[2,this.store.get(e)]}))}))},e.prototype.set=function(e,t){return o(this,void 0,void 0,(function(){var r;return i(this,(function(o){return r=n(n({},t),{id:e}),this.store.set(e,r),[2,r]}))}))},e.prototype.add=function(e){return o(this,void 0,void 0,(function(){var t,r;return i(this,(function(o){return t=(0,a.v4)(),r=n(n({},e),{id:t}),this.store.set(t,r),[2,r]}))}))},e.prototype.delete=function(e){return o(this,void 0,void 0,(function(){return i(this,(function(t){return this.store.delete(e),[2]}))}))},e.prototype.clear=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){return this.store.clear(),[2]}))}))},e.prototype.list=function(e){return o(this,void 0,void 0,(function(){var t,r,n,o,a;return i(this,(function(i){if(t=Array.from(this.store.values()),!e)return[2,t];for((0,u.orderValues)(t,e),r=[],n=0,o=Array.from(this.store.values());n<o.length;n++){if(a=o[n],(0,u.isMatchingQuery)(a,e)){if(e.offset&&r.length<e.offset)continue;r.push(a)}if(e.limit&&r.length>=e.limit)break}return[2,r]}))}))},e.prototype.count=function(e){return o(this,void 0,void 0,(function(){var t,r,n,o;return i(this,(function(i){if(!e)return[2,this.store.size];for(t=0,r=0,n=Array.from(this.store.values());r<n.length;r++)o=n[r],(0,u.isMatchingQuery)(o,e)&&(t+=1);return[2,t]}))}))},e.prototype.calculateSize=function(){return o(this,void 0,void 0,(function(){var e,t,r,n,o;return i(this,(function(i){for(e=0,t=0,r=Array.from(this.store.values());t<r.length;t++)n=r[t],o=new Blob([JSON.stringify(n)]).size,e+=o;return[2,e]}))}))},e}();t.InMemoryDatabaseTableConnector=s},903:e=>{e.exports=require("uuid")}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n].call(i.exports,i,i.exports,r),i.exports}r(835),r(917)})();